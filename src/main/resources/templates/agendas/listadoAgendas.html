<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{fragments/layout}">
<head>
<title>Listado de Consultas</title>
<meta charset="utf-8">
</head>

<body>
	<div layout:fragment="content">	
	
		<div class="card">
			<div class="card-header">
				<div class="row">
					<div class="col-sm-3"><i class="fas fa-user-md text-success"></i> Listado de Consultas</div>
					<div class="col-sm-2"><a class="btn btn-sm close" th:href="@{/agendas/pagas}"><i class="mdi mdi-calendar-check text-success"></i> Pagas</a></div>
					<div class="col-sm-3 text-left"><a class="btn btn-sm close" th:href="@{/agendas/pendentesPagamento}"><i class="mdi mdi-calendar-clock text-info"></i> Pendentes de Pagamento</a></div>				
					<div class="col-sm-2"></div>
					<a th:href="@{/agendas/novo}" class="col-sm-2 text-center btn btn-sm close"><i class="mdi mdi-plus-circle text-success"></i> Agenda</a>
				</div>				
			</div>
			<div class="card-body">	
			
			<div class="alert alert-dismissible alert-info" th:if="${msgInfo}">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				<div><i class="mdi mdi-check-circle"></i> [[${msgInfo}]]</div>
			</div>
			<div class="alert alert-dismissible bg-danger" th:if="${msgError}">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				<div><i class="mdi mdi-exclamation-circle"></i> [[${msgError}]]</div>
			</div>
	
			
			<div class="table-responsive-sm">		
				<table class="table table-hover table-bordered table-sm">
					<thead class="thead-light">
						<tr>
							<th>Médico</th>
							<th>Data</th>
							<th>Inicio</th>
							<th>Fim</th>
							<th>Valor</th>
							<th>Paciente</th>
							<th>Pagamento</th>
							<th></th>
							<th width="50px"></th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="agenda : ${agendas}">
							<td>[[${agenda.medico?.nome}]]</td>
							<td>[[${#dates.format(agenda.data, "dd-MMM-yyyy")}]]</td>
							<td>[[${agenda.inicio}]]</td>
							<td>[[${agenda.fim}]]</td>
							<td>[[${#numbers.formatDecimal(agenda.valor, 1, 'DEFAULT', 2, 'DEFAULT')}]]</td>							
							<td>[[${agenda.paciente.nome}]]</td>
							<td>[[${agenda.indicadorPagamento}]]</td>	
							<td class="text-center">
								<a th:if="${not agenda.paga}" th:href="@{/agendas/efetuarPagamento/{id}(id=${agenda.id})}"><span class="badge badge-info"><i class="mdi mdi-currency-usd"></i> Efetuar pagamento</span></a>		
								<span th:if="${agenda.paga}" class="badge badge-success"><i class="mdi mdi-currency-usd"></i> Pagamento Efectuado</span>					
							</td>							
							<td>
								<a  data-toggle="tooltip" title="Edit" data-placement="right"><i class="mdi mdi-pencil-box text-primary"></i></a>
								<a onclick="return confirm('Estás seguro?')" th:href="@{/agendas/delete/{id}(id=${agenda.id})}" data-toggle="tooltip" title="Delete" data-placement="right"><i class="mdi mdi-delete text-danger"></i></a>
							</td>							
						</tr>
					</tbody>				
				</table>
			</div>	
			</div>			
		</div>		
	</div>	
	<th:block layout:fragment="js-extra">
		<!-- JS HERE -->
	</th:block>
</body>
</html>